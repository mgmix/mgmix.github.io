<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="links: [[_index]]
Repository  MartinFolwer 의 페이지의 Repository 페이지를 읽고 정리
 ![[notes/images/Pasted image 20230819184124.png]]
복잡한 도메인 모델을 가진 시스템은 데이터매퍼(Data Mapper) 와 같은 계층을 활용하면 도메인 객체를 데이터베이스 접근 코드(SQL Query 와 같은)의 세부 구현 사항으로부터 격리 시킬 수 있습니다."><meta property="og:title" content="MartinFowler - Repository"><meta property="og:description" content="links: [[_index]]
Repository  MartinFolwer 의 페이지의 Repository 페이지를 읽고 정리
 ![[notes/images/Pasted image 20230819184124.png]]
복잡한 도메인 모델을 가진 시스템은 데이터매퍼(Data Mapper) 와 같은 계층을 활용하면 도메인 객체를 데이터베이스 접근 코드(SQL Query 와 같은)의 세부 구현 사항으로부터 격리 시킬 수 있습니다."><meta property="og:type" content="website"><meta property="og:image" content="https://mgmix.github.io/icon.png"><meta property="og:url" content="https://mgmix.github.io/notes/MartinFowler-Repository/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="MartinFowler - Repository"><meta name=twitter:description content="links: [[_index]]
Repository  MartinFolwer 의 페이지의 Repository 페이지를 읽고 정리
 ![[notes/images/Pasted image 20230819184124.png]]
복잡한 도메인 모델을 가진 시스템은 데이터매퍼(Data Mapper) 와 같은 계층을 활용하면 도메인 객체를 데이터베이스 접근 코드(SQL Query 와 같은)의 세부 구현 사항으로부터 격리 시킬 수 있습니다."><meta name=twitter:image content="https://mgmix.github.io/icon.png"><title>MartinFowler - Repository</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://mgmix.github.io//icon.png><link href=https://mgmix.github.io/styles.80333fa2099c0bee674efa435fde378c.min.css rel=stylesheet><link href=https://mgmix.github.io/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://mgmix.github.io/js/darkmode.b3965eff34cb00f48d85577f393880af.min.js></script>
<script src=https://mgmix.github.io/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://mgmix.github.io/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://mgmix.github.io/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://mgmix.github.io/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://mgmix.github.io/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://mgmix.github.io/",fetchData=Promise.all([fetch("https://mgmix.github.io/indices/linkIndex.58a5aa7d834d047499042ee431dcb794.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://mgmix.github.io/indices/contentIndex.0e33d2786f75cbd52cda2c32716cf187.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://mgmix.github.io",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://mgmix.github.io",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/mgmix.github.io\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=mgmix.github.io src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://mgmix.github.io/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://mgmix.github.io/>Evan's garden</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>MartinFowler - Repository</h1><p class=meta>Last updated
Aug 19, 2023</p><ul class=tags><li><a href=https://mgmix.github.io/tags/software/>Software</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><ol><li><a href=#간단한-예시-코드>간단한 예시 코드</a></li></ol></li></ol></nav></details></aside><p>links: <a href rel=noopener class=internal-link data-src>_index</a></p><a href=#repository><h1 id=repository><span class=hanchor arialabel=Anchor># </span>Repository</h1></a><blockquote><p>MartinFolwer 의 페이지의 Repository 페이지를 읽고 정리</p></blockquote><p><img src="/notes/images/Pasted image 20230819184124.png" width=auto></p><p>복잡한 도메인 모델을 가진 시스템은 데이터매퍼(Data Mapper) 와 같은 계층을 활용하면 도메인 객체를 데이터베이스 접근 코드(SQL Query 와 같은)의 세부 구현 사항으로부터 격리 시킬 수 있습니다. 여기서 매핑 계층위에 추상화 계층을 추가하면, 이 추상화된 계층에는 쿼리 작성 코드가 집중적으로 만들어집니다. 그렇기에 이 계층을 통해 분산되어있던 중복된 쿼리 로직이 최소화 되는데 도움이 됩니다.</p><p>이해를 돕기 위해 예를 들어보겠습니다. 시스템 내에 수많은 도메인 클래스가 존재하거나 복잡한 쿼리가 많이 필요한 경우를 상상해보세요. 이런 상황에서는 매번 비슷한 쿼리를 반복해서 작성하는 것이 번거롭고 오류 발생 가능성이 높아집니다. 따라서 매핑 계층 위에 쿼리 생성 코드에 집중되는 추상화 계층을 만들어 두면, 중복된 로직을 줄일 수 있습니다.</p><p>쉽게 말해서, 이런 상황에서는 (1)데이터 매퍼가 도메인 객체와 데이터베이스 간의 연결을 관리해주고, 그 위에 (2)쿼리를 생성하고 실행하는 계층을 더 만들면 유용합니다. 이렇게 함으로써 코드를 더 체계적으로 구성할 수 있고, 유지보수가 편리해집니다.</p><p>(1) 데이터 매퍼(Data Mapper) : 우리가 만든 것들을 저장하거나 불러올 때 도움을 줄 수있다.
여기서 데이터 매퍼는 우리가 만든 것들을 저장하는 방법과 꺼내는 방법에 대한 것을 아주 상세하게 알고 있어야한다. 하지만 사용하는 입장에서는 어떻게 동작되는지는 최대한 모르는 것이 편하다.</p><p>(2) 추상화 계층(Repository) : 데이터 매퍼와 우리가 만든 것들을 중간에서 연결해주는 역할을 한다. 데이터를 어떻게 요청하고 받아올지를 정의하고, 우리가 만든 것들이 아주 많거나 복잡할 때 간단하게 만들어 줄 수 있다. 그로 인해 똑같은 일을 반복할 필요가 줄어들게 된다.</p><p>Repository 는 생성한 객체들과 데이터베이스 사이를 연결해주는 중간 역할을 한다. 이렇게 되면 객체들을 메모리에 저장된 컬렉션 처럼 다룰 수 있다.
클라이언트(사용자) 는 무엇을 원하는지 Repository 에 알려주면, Repository 가 그 요청에 맞게 데이터베이스에서 필요한 것을 찾아서 가져다 준다. 객체들은 컬렉션 처럼 Repository 에 추가하거나 삭제할 수 있고 그 과정에서 Repository 안에 구현된 코드가 자동으로 데이터 베이스 작업을 처리해준다.</p><p>이렇게 함으로써 코드를 깔끔하게 유지하고, 객체들이 데이터베이스에 어떻게 저장되고 반환되는지 알 필요가 없도록 도와준다.</p><p>도메인 주도 설계 (Domain Driven Design) 에서 이러한 패턴에 대한 좋을 설명을 찾아볼 수 있다.</p><hr><a href=#간단한-예시-코드><h3 id=간단한-예시-코드><span class=hanchor arialabel=Anchor># </span>간단한 예시 코드</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=c1>// Domain 모델 정의
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>Book</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=kt>int</span> <span class=n>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=kt>String</span> <span class=n>title</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=kt>String</span> <span class=n>author</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>Book</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>id</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=n>title</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=n>author</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=kt>String</span> <span class=n>toString</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;Book(id: </span><span class=si>$</span><span class=n>id</span><span class=s1>, title: </span><span class=si>$</span><span class=n>title</span><span class=s1>, author: </span><span class=si>$</span><span class=n>author</span><span class=s1>)&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>User</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=kt>int</span> <span class=n>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=kt>String</span> <span class=n>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>User</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>id</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=n>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>override</span>
</span></span><span class=line><span class=cl>  <span class=kt>String</span> <span class=n>toString</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;User(id: </span><span class=si>$</span><span class=n>id</span><span class=s1>, name: </span><span class=si>$</span><span class=n>name</span><span class=s1>)&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=c1>// 데이터 베이스
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>Database</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Book</span><span class=o>&gt;</span> <span class=n>books</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>users</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 데이터 매퍼 정의 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>BookDataMapper</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl> <span class=kd>final</span> <span class=n>Database</span> <span class=n>_database</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=n>BookDataMapper</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>_database</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl> <span class=kt>void</span> <span class=n>save</span><span class=p>(</span><span class=n>Book</span> <span class=n>book</span><span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>	<span class=n>_database</span><span class=p>.</span><span class=n>books</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>book</span><span class=p>);</span> 
</span></span><span class=line><span class=cl> <span class=p>}</span> 
</span></span><span class=line><span class=cl>	    
</span></span><span class=line><span class=cl> <span class=n>List</span><span class=o>&lt;</span><span class=n>Book</span><span class=o>&gt;</span> <span class=n>getAllBooks</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>_database</span><span class=p>.</span><span class=n>books</span><span class=p>.</span><span class=n>toList</span><span class=p>();</span> 
</span></span><span class=line><span class=cl> <span class=p>}</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>class</span> <span class=nc>UserDataMapper</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kd>final</span> <span class=n>Database</span> <span class=n>_database</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=n>UserDataMapper</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>_database</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>void</span> <span class=n>save</span><span class=p>(</span><span class=n>User</span> <span class=n>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>_database</span><span class=p>.</span><span class=n>users</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>getAllUsers</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>_database</span><span class=p>.</span><span class=n>users</span><span class=p>.</span><span class=n>toList</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=c1>// Repository 에서는 DataSource 로 데이터를 요청하고 결과를 반환하는 것만 정의를 하면된다.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>class</span> <span class=nc>LibraryRepository</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>BookDataMapper</span> <span class=n>_bookDataMapper</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>UserDataMapper</span> <span class=n>_userDataMapper</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>LibraryRepository</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=n>_bookDataMapper</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=n>_userDataMapper</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>List</span><span class=o>&lt;</span><span class=n>Book</span><span class=o>&gt;</span> <span class=n>searchBooksByAuthor</span><span class=p>(</span><span class=kt>String</span> <span class=n>author</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>_bookDataMapper</span><span class=p>.</span><span class=n>getAllBooks</span><span class=p>().</span><span class=n>where</span><span class=p>((</span><span class=n>book</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=n>book</span><span class=p>.</span><span class=n>author</span> <span class=o>==</span> <span class=n>author</span><span class=p>).</span><span class=n>toList</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>List</span><span class=o>&lt;</span><span class=n>User</span><span class=o>&gt;</span> <span class=n>getAllUsers</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>_userDataMapper</span><span class=p>.</span><span class=n>getAllUsers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=kt>void</span> <span class=n>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>bookDataMapper</span> <span class=o>=</span> <span class=n>BookDataMapper</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>userDataMapper</span> <span class=o>=</span> <span class=n>UserDataMapper</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>libraryRepository</span> <span class=o>=</span> <span class=n>LibraryRepository</span><span class=p>(</span><span class=n>bookDataMapper</span><span class=p>,</span> <span class=n>userDataMapper</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>bookDataMapper</span><span class=p>.</span><span class=n>save</span><span class=p>(</span><span class=n>Book</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=s1>&#39;Dart Programming&#39;</span><span class=p>,</span> <span class=s1>&#39;John Doe&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=n>bookDataMapper</span><span class=p>.</span><span class=n>save</span><span class=p>(</span><span class=n>Book</span><span class=p>(</span><span class=m>2</span><span class=p>,</span> <span class=s1>&#39;Flutter Basics&#39;</span><span class=p>,</span> <span class=s1>&#39;Jane Smith&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>userDataMapper</span><span class=p>.</span><span class=n>save</span><span class=p>(</span><span class=n>User</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=s1>&#39;Alice&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=n>userDataMapper</span><span class=p>.</span><span class=n>save</span><span class=p>(</span><span class=n>User</span><span class=p>(</span><span class=m>2</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Repository 를 사용하는 입장에서는, Repository 에 정의된 메소드만 호출하면 이 데이터의 소스나 어떻게 가져올 것인지등에 대해서는 신경 쓸 필요가 없다.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>final</span> <span class=n>booksByAuthor</span> <span class=o>=</span> <span class=n>libraryRepository</span><span class=p>.</span><span class=n>searchBooksByAuthor</span><span class=p>(</span><span class=s1>&#39;John Doe&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kd>final</span> <span class=n>allUsers</span> <span class=o>=</span> <span class=n>libraryRepository</span><span class=p>.</span><span class=n>getAllUsers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>print</span><span class=p>(</span><span class=s1>&#39;Books by John Doe: </span><span class=si>$</span><span class=n>booksByAuthor</span><span class=s1>&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>print</span><span class=p>(</span><span class=s1>&#39;All Users: </span><span class=si>$</span><span class=n>allUsers</span><span class=s1>&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/notes/-Software-engineering-MOC/ data-ctx="Repository Pattern" data-src=/notes/-Software-engineering-MOC class=internal-link>👨‍💻 Software engineering MOC</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://mgmix.github.io/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Evan Song using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://mgmix.github.io/>Home</a></li><li><a href=https://github.com/mgmix>Github</a></li></ul></footer></div></div></body></html>